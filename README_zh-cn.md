## 简介

Universal Localization Translator（ULT 文档编辑器）是一款面向文本/字幕/脚本等文件格式的AI辅助翻译工具。它集成了主流人工智能大语言模型API接口（如ChatGPT，DeepSeek等），同时支持本地运行的大语言模型加载程序提供的API。支持单行逐句翻译、批量翻译、选区翻译以及项目化管理，帮助你在保持语气、标点、格式的前提下，高效完成多语种翻译工作。同时内置了语言识别算法，可自动过滤掉无需翻译或无法翻译的内容，从而节省token开销。

### 主要特性
- 翻译引擎可配：自定义 API Key、Base URL、模型名、系统提示词（支持 `{source_lan}` / `{target_lan}` 自动替换）。
- 单行翻译预览：在编辑器内直接预览译文，Tab 确认、ESC 取消翻译，便于校对。
- 批量翻译：可按“单次请求句子数”（来自 API 配置）将待翻译内容自动分批，回显为逐行预览，API请求失败可自动回退到逐句翻译。
- 选区翻译：可对选中段落强制翻译，忽略语言识别和自动断句等纠错机制。
- 语言检测：基础检测 + 精确检测（可开关），智能判断是否需要翻译。
- 项目管理：集中管理工程，记录上次光标、语言设置、API配置等。
- 主题适配：支持深色模式，适合长时间文字校对工作。

### 当前支持的文档类型
- JSON / TXT / LRC / SRT / XML / HTML（会根据类型采用合适的文本抽取/替换策略）

### 基本使用流程
1. 打开软件 → 进入“项目管理器”加载/新建工程文件。
2. 通过“API配置”设置翻译服务：API Key、Base URL、模型名、系统提示词、单次请求句子数。
3. 在工具栏选择“源语言/目标语言”（此处的选项会自动替换API配置中系统提示词内的{source_lan}和{target_lan}标签）。
4. 支持在编辑器中进行逐行预览和逐行修改校对，之后可按Tab键确认并替换翻译结果，也可按ESC键取消翻译。
5. 需要时使用“选区翻译”对任意段落强制翻译。
6. 保存文件。

---

## 进阶使用说明

### 1. 项目管理器
- 打开方式：启动软件，或在文档编辑器界面点击“项目管理”。
- 项目管理功能：搜索、打开、重命名、查看编辑进度、删除（不删除原始文件）。
- 双击列表或选中后“打开”进入编辑。

### 2. API 配置（独立窗口）
- 打开方式：主界面“API配置”。
- 配置项：
  - API Key：服务商密钥。
  - Base URL：如 `https://api.deepseek.com/v1`。（任何兼容ChatGPT API的URL都被支持）
  - 模型名：如 `deepseek-reasoner`。（需根据相关平台的API接口文档而定）
  - 系统提示词：控制翻译风格与规范，支持 `{source_lan}` / `{target_lan}` 占位符。
  - 单次请求句子数：控制批量请求每次携带的句子数量（1~1000），不同 API 可独立设置，防止响应时间过长、超出上下文长度限制或出现频繁超时。
- 操作：新建/保存/测试连接。

### 3. 语言与文档类型
- 文档类型：JSON/TXT/LRC/SRT/XML/HTML；影响行内文本抽取/替换策略（如 XML/HTML 仅替换标签内文）。
- 源/目标语言：下拉选择（中文/英语/日语/德语/法语/西班牙语/葡萄牙语/意大利语/俄语/越南语）。
- 语言检测：
  - 基础检测：脚本特征/词频等，轻量快速。
  - 精确检测：复杂算法，轻微增加提交翻译指令前的延迟，但可进一步降低误发送非待翻译文本的概率，开/关可选。

### 4. 单行翻译预览
- 触发：通过鼠标点击或方向键移动光标到待翻译内容所在行的任意位置，等待2秒后软件会自动识别当前行的内容并将内容提交给API进行翻译请求。
- 展示：在原文下一行内联 `// 翻译预览: ...    按Tab确认，按ESC取消`。
- 操作：按Tab键确认将翻译预览写回原处，按ESC键取消翻译并自动清除翻译预览。预览状态下有按键保护，不响应其他操作，避免误操作。

### 5. 批量翻译
- 用途：同时处理多行文本/字幕，便于大语言模型根据上下文进行更精确翻译，同时节约token开销。
- 过程：按当前 API 的“单次请求句子数”分批请求 → 解析为逐行预览 → 批量确认/取消。

### 6. 选区翻译
- 在编辑器中用鼠标拖动选中任意选择文本 → 按鼠标中键提交翻译请求 → 显示“选区翻译预览” → Tab 确认 / ESC 取消。
- 不影响光标与其他自动流程。

### 7. 状态栏与主题
- 状态栏：
  - 左侧：软件状态（AI 开关、配置加载、项目打开等）。
  - 中部：翻译流程状态（进行中/完成/错误信息/预览提示等）。
  - 右侧：光标信息（当前行、位置百分比）。
- 主题：深色模式对标题栏、滚动条、树控件、输入控件做了针对性增强，适合长时间进行文本编辑/校对时缓解视疲劳。

### 9. 按键操作
- Tab：确认当前行“翻译预览”。
- ESC：取消当前所有“翻译预览”并清除相关预览内容。
- 鼠标中键：对选区文本进行强制翻译请求。

### 11. 常见问题（节选）
- 批量解析数量不匹配？→ 自动回退逐句单行补齐；可增大/减小“单次请求句子数”。
- API 超时频繁？→ 降低“单次请求句子数”、提高超时时间、检查网络或切换更稳定模型/服务商。
- 只返回译文？→ 在“系统提示词”中明确“只返回结果，不要解释/思考过程”，程序也会对预览文本做清洗。


